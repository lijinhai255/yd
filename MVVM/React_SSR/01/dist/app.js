(()=>{"use strict";var e={555:e=>{e.exports=require("@koa/router")},639:e=>{e.exports=require("koa")},835:e=>{e.exports=require("koa-static")}},t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={exports:{}};return e[r](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=require("react");var t=a.n(e);const r=require("react-dom/server"),n=require("react-router-dom"),o=require("react-router-config"),l=require("axios");var s=a.n(l);const c=require("react-redux");class i extends t().Component{constructor(...e){var t,a;super(...e),a={data:""},(t="state")in this?Object.defineProperty(this,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[t]=a}static getSomeData(e){return console.log(e,"store"),new Promise((t=>{s().get("http://localhost:3001/getData").then((({data:a})=>{console.log(a.data),e.dispatch({type:"CHANGE_HOME_DATA",payload:{data:a.data}}),t({data:a.data})}))}))}componentDidMount(){console.log(1212121),this.setState({data:this.props.data})}render(){return t().createElement(t().Fragment,null,t().createElement("h1",null,"Home"),t().createElement("h2",null,this.props.data),t().createElement("p",null,"12121"),t().createElement("h2",null,this.state.data))}}const u=(0,c.connect)((function(e){return{data:e.data}}))(i);class d extends t().Component{constructor(...e){var t,a;super(...e),a={data:""},(t="state")in this?Object.defineProperty(this,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[t]=a}componentDidMount(){s().get("http://localhost:3001/getData").then((({data:e})=>{console.log(e,"data"),this.setState({data:e.data})}))}render(){return t().createElement(t().Fragment,null,t().createElement("h1",null,"about"),t().createElement("h2",null,this.state.data))}}const m=d,p=[{path:"/",component:u,exact:!0,loadData:u.getSomeData},{path:"/about",exact:!0,component:m}];function h(){return t().createElement("div",null,t().createElement("nav",null,t().createElement("ul",null,t().createElement("li",null,t().createElement(n.Link,{to:"/"},"Home")),t().createElement("li",null,t().createElement(n.Link,{to:"/about"},"About")))),(0,o.renderRoutes)(p))}const g=require("redux"),E={data:""};function b(e=E,t){switch(t.type){case"CHANGE_HOME_DATA":return{...e,...t.payload};default:return{...e}}}const v=a(639),f=a(835),y=a(555),w=new v,x=new y;x.get(["/","/about"],(async(e,a)=>{const o=[];let l="";const s=(0,g.createStore)(b);console.log(s,"12121"),p.some((t=>{const a=(0,n.matchPath)(e.request.path,t);return a&&t.loadData&&o.push(t.loadData(s)),a})),await Promise.all(o).then((a=>{console.log("data",a),l=(0,r.renderToString)(t().createElement(c.Provider,{store:s},t().createElement(n.StaticRouter,{location:e.req.url},t().createElement(h,null))))})),console.log(l),e.body=`\n    <!DOCTYPE html>\n        <html lang="en">\n        <head>\n            <meta charset="UTF-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>React SSR</title>\n        </head>\n        <body>\n            <div id="root">${l}</div>\n            <script>\n            window.REDUX_STORE = ${JSON.stringify(s.getState())}<\/script>\n            <script src="./script/bundle.js"><\/script>\n\n        </body>\n    </html>\n    `})),x.get("/getData",(e=>{e.body={code:0,message:"",data:"后端返回的数据"}})),w.use(f("assets")),w.use(x.routes()).use(x.allowedMethods()),w.listen(3001,(()=>{console.log("server is running121")}))})()})();